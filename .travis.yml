language: generic
sudo: required

notifications:
  email: false

before_script:
  - chmod +x devops/scripts/check-target-changes.sh
  - chmod +x devops/scripts/ci.run-target.sh
  - chmod +x devops/scripts/ci.run-all.sh
  - chmod +x devops/scripts/auto_merge.sh
  - chmod +x devops/scripts/after_success.sh
  - chmod +x devops/scripts/ci.lint.sh

branches:
  only:
    - master

#jobs:
#  include:
#    - stage: lint-test
#      script: ./devops/scripts/ci.run-all.sh client
#    - script: ./devops/scripts/ci.run-all.sh auth-service
#    - script: ./devops/scripts/ci.run-all.sh products
#    - stage: deploy
#      script: ./deploy

#matrix:
#  include:
#    - env: TARGET=client
#    - env: TARGET=auth-service
#    - env: TARGET=products-service

#env:
#  - TARGET=client
#  - TARGET=auth-service
#  - TARGET=products-service
#
#script: ./devops/scripts/ci.run-all.sh


jobs:
  include:
    - stage: lint
      script: ./devops/scripts/ci.lint.sh client lint
    - script: ./devops/scripts/ci.lint.sh auth-service lint
    - script: ./devops/scripts/ci.lint.sh products-service lint

